

<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

 


      <title>Evolving Algorithms with Tree Genomes in JAX - </title>

  <meta name="description" content="In 2024 code for genetic programming in JAX
An example tree decomposition of a common ML hidden layer looks like this. Variables (or tensors thereof) are terminals and operators are nodes. This tree would correspond to a tree-shaped genome which can copy, mutate, and recombine its branches at any level.
$Y=W_1\text{ReLU}(W_0X&#43;b_0)&#43;b_1$
flowchart TD
  &#43; --- MatMul
  &#43; --- b
  MatMul---ReLU
  MatMul---W1[W]
  ReLU---&#43;0[&#43;]
  &#43;0[&#43;]---MatMul0[MatMul]
  &#43;0[&#43;]---b0[b]
  MatMul0[MatMul]---W0[W]
  MatMul0[MatMul]---X
The multilayer feed-forward network needs no new elements, just a single recombination of &lsquo;X&rsquo; with an entire identical genome:"><script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "WebSite",
    "name": "Kevin L. McKee",
    
    "url": "http:\/\/localhost:1313\/"
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": "",
  "url": "http:\/\/localhost:1313\/"
  
  
  
  
}
</script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "item": {
          "@id": "http:\/\/localhost:1313\/",
          "name": "home"
        }
    },{
        "@type": "ListItem",
        "position": 3,
        "item": {
          "@id": "http:\/\/localhost:1313\/posts\/tree-genomes\/",
          "name": "Evolving algorithms with tree genomes in jax"
        }
    }]
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "author": {
    "name" : ""
  },
  "headline": "Evolving Algorithms with Tree Genomes in JAX",
  "description" : "In 2024 code for genetic programming in JAX\nAn example tree decomposition of a common ML hidden layer looks like this. Variables (or tensors thereof) are terminals and operators are nodes. This tree would correspond to a tree-shaped genome which can copy, mutate, and recombine its branches at any level.\n$Y=W_1\\text{ReLU}(W_0X\u002bb_0)\u002bb_1$\nflowchart TD \u002b --- MatMul \u002b --- b MatMul---ReLU MatMul---W1[W] ReLU---\u002b0[\u002b] \u002b0[\u002b]---MatMul0[MatMul] \u002b0[\u002b]---b0[b] MatMul0[MatMul]---W0[W] MatMul0[MatMul]---X The multilayer feed-forward network needs no new elements, just a single recombination of \u0026lsquo;X\u0026rsquo; with an entire identical genome:\n",
  "inLanguage" : "en",
  "wordCount":  381 ,
  "datePublished" : "2025-08-03T09:25:40-04:00",
  "dateModified" : "2025-08-03T09:25:40-04:00",
  "image" : "http:\/\/localhost:1313\/",
  "keywords" : [ "" ],
  "mainEntityOfPage" : "http:\/\/localhost:1313\/posts\/tree-genomes\/",
  "publisher" : {
    "@type": "Organization",
    "name" : "http:\/\/localhost:1313\/",
    "logo" : {
        "@type" : "ImageObject",
        "url" : "http:\/\/localhost:1313\/",
        "height" :  60 ,
        "width" :  60
    }
  }
}
</script>


<meta property="og:title" content="Evolving Algorithms with Tree Genomes in JAX" />
<meta property="og:description" content="In 2024 code for genetic programming in JAX
An example tree decomposition of a common ML hidden layer looks like this. Variables (or tensors thereof) are terminals and operators are nodes. This tree would correspond to a tree-shaped genome which can copy, mutate, and recombine its branches at any level.
$Y=W_1\text{ReLU}(W_0X&#43;b_0)&#43;b_1$
flowchart TD
  &#43; --- MatMul
  &#43; --- b
  MatMul---ReLU
  MatMul---W1[W]
  ReLU---&#43;0[&#43;]
  &#43;0[&#43;]---MatMul0[MatMul]
  &#43;0[&#43;]---b0[b]
  MatMul0[MatMul]---W0[W]
  MatMul0[MatMul]---X
The multilayer feed-forward network needs no new elements, just a single recombination of &lsquo;X&rsquo; with an entire identical genome:">
<meta property="og:url" content="http://localhost:1313/posts/tree-genomes/" />
<meta property="og:type" content="website" />
<meta property="og:site_name" content="Kevin L. McKee" />

  <meta name="twitter:title" content="Evolving Algorithms with Tree Genomes in JAX" />
  <meta name="twitter:description" content="In 2024 code for genetic programming in JAX
An example tree decomposition of a common ML hidden layer looks like this. Variables (or tensors thereof) are terminals and operators are nodes. This tree …">
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="generator" content="Hugo 0.150.0">
  <link rel="alternate" href="http://localhost:1313/index.xml" type="application/rss+xml" title="Kevin L. McKee"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.css" integrity="sha384-3UiQGuEI4TTMaFmGIZumfRPtfKQ3trwQE2JgosJxCnGmQpL/lJdjpcHkaaFwHlcI" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.6.0/css/all.css" integrity="sha384-h/hnnw1Bi4nbpD6kE7nYfCXzovi622sY5WBxww8ARKwpdLj5kUWjRuyiXaD1U2JT" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap.min.css" integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu" crossorigin="anonymous"><link rel="stylesheet" href="http://localhost:1313/css/main.css" /><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" />
  <link rel="stylesheet" href="http://localhost:1313/css/highlight.min.css" /><link rel="stylesheet" href="http://localhost:1313/css/codeblock.css" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.css" integrity="sha384-h/L2W9KefUClHWaty3SLE5F/qvc4djlyR4qY3NUV5HGQBBW7stbcfff1+I/vmsHh" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css" integrity="sha384-iD0dNku6PYSIQLyfTOpB06F2KCZJAKLOThS5HRe8b3ibhdEQ6eKsFf/EeFxdOt5R" crossorigin="anonymous">

  </head>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', () => {
  renderMathInElement(document.body, {
    delimiters: [
      {left: '$$', right: '$$', display: true},
      {left: '$', right: '$', display: false},
      {left: '\\(', right: '\\)', display: false},
      {left: '\\[', right: '\\]', display: true}
    ]
  });
});
</script>

  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', () => {
  document.querySelectorAll('pre > code.language-mermaid').forEach((code) => {
    const pre = code.parentElement;
    const wrapper = document.createElement('div');
    wrapper.style.textAlign = 'center';
    const diagram = document.createElement('div');
    diagram.className = 'mermaid';
    diagram.textContent = code.textContent;
    wrapper.appendChild(diagram);
    pre.replaceWith(wrapper);
  });

  mermaid.initialize({
    startOnLoad: true,
    securityLevel: 'loose',
    theme: window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'default'
  });
});
</script>

  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="http://localhost:1313/">Kevin L. McKee</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li>
              <a title="Home" href="/">Home</a>
            </li>
          
        
          
            <li>
              <a title="About" href="/about">About</a>
            </li>
          
        
          
            <li>
              <a title="Research" href="/research">Research</a>
            </li>
          
        
          
            <li>
              <a title="Code" href="/code">Code</a>
            </li>
          
        
          
            <li>
              <a title="Art" href="/art">Art</a>
            </li>
          
        

        

        
      </ul>
    </div>

    

  </div>
</nav>




    


<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>


  
  
  






  

  <header class="header-section ">
    
    
    <div class="intro-header no-img">
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="posts-heading">
              
                <h1>Evolving Algorithms with Tree Genomes in JAX</h1>
              
              
                <hr class="small">
              
              
              
            </div>
          </div>
        </div>
      </div>
    </div>
  
  </header>

    
<div class="container" role="main">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <article role="main" class="blog-post">
        <p>In 2024 <a href="https://github.com/kmckee90/misc_experiments/blob/master/experiments/genetic_programming/jax_gp.py">code for genetic programming in JAX</a></p>
<p>An example tree decomposition of a common ML hidden layer looks like this. Variables (or tensors thereof) are terminals and operators are nodes. This tree would correspond to a tree-shaped genome which can copy, mutate, and recombine its branches at any level.</p>
<p>$Y=W_1\text{ReLU}(W_0X+b_0)+b_1$</p>
<pre tabindex="0"><code class="language-mermaid" data-lang="mermaid">flowchart TD
  + --- MatMul
  + --- b
  MatMul---ReLU
  MatMul---W1[W]
  ReLU---+0[+]
  +0[+]---MatMul0[MatMul]
  +0[+]---b0[b]
  MatMul0[MatMul]---W0[W]
  MatMul0[MatMul]---X
</code></pre><p>The multilayer feed-forward network needs no new elements, just a single recombination of &lsquo;X&rsquo; with an entire identical genome:</p>
<p>$Y = W_2\text{ReLU}(W_1\text{ReLU}(W_0X+b_0)+b_1)+b_2$</p>
<pre tabindex="0"><code class="language-mermaid" data-lang="mermaid">flowchart TD
  
  +3[+] --- MatMul3[MatMul]
  +3 --- b3[b]
  MatMul3---ReLU3[ReLU]
  MatMul3---W3[W]
  
  ReLU3---+
  +---MatMul
  +---b1[b]
  MatMul---W1[W]
  MatMul---2ReLU
  
  2ReLU[ReLU]---+2
  +2[+]---MM2[MatMul]
  +2---b2[b]
  MM2---W2
  MM2---X
</code></pre><p>Recurrent network if H is saved and reused.</p>
<p>$Y = W_2\text{ReLU}(W_1\text{ReLU}(W_0X+b_0)+b_1)+b_2$</p>
<pre tabindex="0"><code class="language-mermaid" data-lang="mermaid">flowchart TD

  +3 --- b3[b2]  
  +3[+] --- MatMul3[MatMul]
  MatMul3---W3[W2]
  MatMul3---H2[H0]---ReLU3[Tanh]
  
  ReLU3---+
  +---MatMul
  +---MatMul4[MatMul]
  +---b1[b1]
  MatMul4---W4[W2]
  MatMul---W1[W1]
  MatMul---2ReLU
  MatMul4---H[H0]
  
  2ReLU[ReLU]---+2
  +2---b2[b0]
  +2[+]---MM2[MatMul]
  MM2---W2[W0]
  MM2---X
</code></pre><p>So this would be a stateful recurrent model, so given this structure, we would need to initialize H0. Probably the easiest thing is to initialize all the terminals, whether or not the initial value is used.</p>
<p>A learning algorithm (the delta rule on a linear model) may look like this:</p>
<p>$Y=W_0X$</p>
<p>$W_0 = W_0 + \text{LR} * X(Y-W_0X)$</p>
<pre tabindex="0"><code class="language-mermaid" data-lang="mermaid">flowchart TD
  mm1[MatMul] --- W[W0]
  W---+0[+]
  +0 --- W0
  +0 --- *0[*]
  *0 --- lr
  *0 --- mm3
  mm3 --- X2[X]
  mm3[MatMul]--- -0[-]
  -0 --- Y
  -0 --- mm2[MatMul]
  mm2 --- W2[W0]
  mm2 --- X
  mm1---X1[X]
  
</code></pre><p>To process, take all the unique terminals and instantiate them based on syntax.</p>
<p>Perhaps symbols are nothing more than things like $W_0 … W_9$ and $H_0 … H_9$ to start off.</p>
<pre tabindex="0"><code class="language-mermaid" data-lang="mermaid">flowchart TD
  mm1---X1[X]
  mm1[MatMul]---+0[+]
  +0 --- W0
  +0 --- *0[*]
  *0 --- LR
  *0 --- mm3
  mm3 --- X2[X]
  mm3[MatMul]--- -0[-]
  -0 --- Y
  -0 --- mm2[MatMul]
  mm2 --- W2[W0]
  mm2 --- X
</code></pre><p>How are numeric values incorporated? Have to think of it in this notation:</p>
<p>$H_0 \gets H_0 + 1$</p>
<pre tabindex="0"><code class="language-mermaid" data-lang="mermaid">flowchart TD
  H0 --- +
  + --- H1[H0]
  + --- 1
</code></pre><p>So $H_0$ is instantiated, say, to a zero vector, but in the model it is calculated as $H_0+1$. Probably we just use natural numbers and allow for subtraction and division.</p>
<p>How are names handled? Perhaps we have a tree of linear genomes that can recombine? Or declarations like VecH0, MatW0, Sca1, ScaLR</p>


        

        
            <hr/>
            <section id="social-share">
              <div class="list-inline footer-links">
                

<div class="share-box" aria-hidden="true">
    <ul class="share">
      
      <li>
        <a href="//twitter.com/share?url=http%3a%2f%2flocalhost%3a1313%2fposts%2ftree-genomes%2f&amp;text=Evolving%20Algorithms%20with%20Tree%20Genomes%20in%20JAX&amp;via=" target="_blank" title="Share on Twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fposts%2ftree-genomes%2f" target="_blank" title="Share on Facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fposts%2ftree-genomes%2f&amp;title=Evolving%20Algorithms%20with%20Tree%20Genomes%20in%20JAX" target="_blank" title="Share on Reddit">
          <i class="fab fa-reddit"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.linkedin.com/shareArticle?url=http%3a%2f%2flocalhost%3a1313%2fposts%2ftree-genomes%2f&amp;title=Evolving%20Algorithms%20with%20Tree%20Genomes%20in%20JAX" target="_blank" title="Share on LinkedIn">
          <i class="fab fa-linkedin"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.stumbleupon.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fposts%2ftree-genomes%2f&amp;title=Evolving%20Algorithms%20with%20Tree%20Genomes%20in%20JAX" target="_blank" title="Share on StumbleUpon">
          <i class="fab fa-stumbleupon"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.pinterest.com/pin/create/button/?url=http%3a%2f%2flocalhost%3a1313%2fposts%2ftree-genomes%2f&amp;description=Evolving%20Algorithms%20with%20Tree%20Genomes%20in%20JAX" target="_blank" title="Share on Pinterest">
          <i class="fab fa-pinterest"></i>
        </a>
      </li>
    </ul>
  </div>
  

              </div>
            </section>
        

        
          

          
        
      </article>

      
        <ul class="pager blog-pager">
          
            <li class="previous">
              <a href="http://localhost:1313/posts/ccnlab/" data-toggle="tooltip" data-placement="top" title="New position at CCNLab">&larr; Previous Post</a>
            </li>
          
          
            <li class="next">
              <a href="http://localhost:1313/posts/snn-demo/" data-toggle="tooltip" data-placement="top" title="What kind of algorithms run in a soup?">Next Post &rarr;</a>
            </li>
          
        </ul>
      


      
      
      
      
      
        
      

    </div>
  </div>
</div>

      <footer>
  <div class="container">
    
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
              <li>
		
		  <a href="mailto:kmckee90@gmail.com" title="Email me">
		
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fas fa-envelope fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
		
		  <a href="https://github.com/kmckee90" title="GitHub">
		
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
		
		  <a href="https://linkedin.com/in/kevin-mckee-18a2561a0" title="LinkedIn">
		
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
          
          
          
        </ul>
        <p class="credits copyright text-muted">
          

          &nbsp;&bull;&nbsp;&copy;
          
            2025
          

          
            &nbsp;&bull;&nbsp;
            <a href="http://localhost:1313/">Kevin L. McKee</a>
          
        </p>
        
        <p class="credits theme-by text-muted">
          <a href="https://gohugo.io">Hugo v0.150.0</a> powered &nbsp;&bull;&nbsp; Theme <a href="https://github.com/halogenica/beautifulhugo">Beautiful Hugo</a> adapted from <a href="https://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a>
          
        </p>
      </div>
    </div>
  </div>
</footer><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.js" integrity="sha384-G0zcxDFp5LWZtDuRMnBkk3EphCK1lhEf4UEyEM693ka574TZGwo4IWwS6QLzM/2t" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
<script src="https://code.jquery.com/jquery-3.7.0.slim.min.js" integrity="sha384-w5y/xIeYixWvfM+A1cEbmHPURnvyqmVg5eVENruEdDjcyRLUSNej7512JQGspFUr" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/js/bootstrap.min.js" integrity="sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd" crossorigin="anonymous"></script>

<script src="http://localhost:1313/js/main.js"></script>
<script src="http://localhost:1313/js/highlight.min.js"></script>
<script> hljs.initHighlightingOnLoad(); </script>
<script> $(document).ready(function() {$("pre.chroma").css("padding","0");}); </script><script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js" integrity="sha384-QELNnmcmU8IR9ZAykt67vGr9/rZJdHbiWi64V88fCPaOohUlHCqUD/unNN0BXSqy" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js" integrity="sha384-m67o7SkQ1ALzKZIFh4CiTA8tmadaujiTa9Vu+nqPSwDOqHrDmxLezTdFln8077+q" crossorigin="anonymous"></script><script src="http://localhost:1313/js/load-photoswipe.js"></script>










    
  </body>
</html>

